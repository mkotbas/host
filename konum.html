<!DOCTYPE html>
<html lang="tr">
<head>
    <!-- Diğer head içeriği aynı kalacak -->
</head>
<body>
    <!-- Diğer HTML içeriği aynı kalacak -->

    <script>
        // Diğer fonksiyonlar aynı kalacak

        function displayResults(data) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            const resultsTable = document.getElementById('resultsTable');

            if (data.length > 1) {
                resultsTable.style.display = 'table';
            } else {
                resultsTable.style.display = 'none';
            }

            data.forEach((row, index) => {
                if (index === 0) return;

                const tr = document.createElement('tr');

                ['Şehir', 'İlçe', '', 'Bayi Kodu', 'Bayi Adı', 'Konum'].forEach((_, colIndex) => {
                    const td = document.createElement('td');
                    if (colIndex === 2) {
                        const checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.classList.add('checkbox');
                        td.appendChild(checkbox);
                    } else {
                        if (colIndex === 5 && row[colIndex]) {
                            const coordinates = row[colIndex];

                            const gMapLink = document.createElement('button');
                            gMapLink.className = 'map-button google';
                            gMapLink.title = 'Google Haritalar\'da aç';
                            gMapLink.innerHTML = 'G';
                            gMapLink.addEventListener('click', () => {
                                window.open(`https://www.google.com/maps?q=${coordinates}`, '_blank');
                            });

                            const yMapLink = document.createElement('button');
                            yMapLink.className = 'map-button yandex';
                            yMapLink.title = 'Yandex Haritalar\'da aç';
                            yMapLink.innerHTML = 'Y';
                            yMapLink.addEventListener('click', () => {
                                const coords = coordinates.replace(/,/g, '%2C').replace(/\s/g, '');
                                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                                
                                if (isMobile) {
                                    window.open(`yandexmaps://maps.yandex.com/?ll=${coords}&z=16&pt=${coords}`, '_blank');
                                    // Eğer uygulama yoksa tarayıcıya yönlendir
                                    setTimeout(() => {
                                        window.open(`https://yandex.com.tr/harita/?ll=${coords}&z=16&pt=${coords}`, '_blank');
                                    }, 500);
                                } else {
                                    window.open(`https://yandex.com.tr/harita/?ll=${coords}&z=16&pt=${coords}`, '_blank');
                                }
                            });

                            const copyBtn = document.createElement('button');
                            copyBtn.className = 'map-button copy';
                            copyBtn.title = 'Koordinatları kopyala';
                            copyBtn.innerHTML = 'K';
                            copyBtn.addEventListener('click', () => {
                                navigator.clipboard.writeText(coordinates).then(() => {
                                    alert('Koordinatlar kopyalandı.');
                                });
                            });

                            td.appendChild(gMapLink);
                            td.appendChild(yMapLink);
                            td.appendChild(copyBtn);
                        } else {
                            td.textContent = row[colIndex] || '';
                        }
                    }
                    tr.appendChild(td);
                });

                tableBody.appendChild(tr);
            });
        }

        // Diğer JavaScript kodları aynı kalacak
    </script>
</body>
</html>
